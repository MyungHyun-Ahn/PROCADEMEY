# TCP 1
### TCP 특징
* 연결형
* 신뢰성
  * 데이터 누락, 순서 맞춤을 연결이 유지되는 전제에서 보장
  * 끊어지기 전의 데이터는 갔을 수도 안 갔을 수도 있다.
* 일대일 통신
  * 두 호스트 간 1 : 1 Unicast 통신
* 데이터 경계 구분 안함

### Half - close
연결의 유지
* 각 호스트의 메모리에 연결 상태를 저장하고 있는 것
* IP : 포트 쌍

만약 어느 한쪽이 컴퓨터를 강제로 끔
* RST 혹은 FIN 패킷을 보내지 않을 수도 있다.
* 그럼 이때는 상대방이 직접 패킷을 보내기 전까지는 연결의 유효성을 알 수 없다.

모바일 환경에서
* 주변의 환경 변화로 인해 이러한 경우가 잦다.
* half-close 를 일으키는 경우가 많음
* 따라서 rudp를 구현하는 경우가 많음

### UDP 특징
* 비연결형
* 신뢰성 없음
* 일대일 통신, 일대다 통신 - broadcast
* 데이터 경계 구분함
  * 충분히 큰 버퍼로 한번에 받아야 함
    * recv할 때 항상 최대 크기로
  * 데이터의 순서가 꼬일수도 있다.
  * L2 차원에서는 순서대로 간다. - 경로가 1개
  * L3 차원부터 경로가 바뀔 수 있다.
    * 자주 발생하지는 않는다.

UDP 헤더 - 8바이트
* src port, dest port
* length, checksum

### RUDP
* UDP 인데 TCP의 장점을 구현해서 사용하는 것

### DDOS
* TCP에서는 불가능
* 트래픽을 과도하게 쏟아부어 장애를 유발

두 가지 방식
* 어플리케이션 로직을 과부하시키는 방식
* 네트워크 장비를 다운시키는 방식
  * 이것이 흔히 사용됨

IDC 센터 되팔이
* 실제 기업들에게 서버를 대여
* 이 백본을 수많은 기업들이 나눠 쓰는 것
* 이 백본을 마비시킬 만큼의 트래픽을 통해 라우터나 스위치를 마비시켜야 함
  * udp만 가능
  * tcp는 연결 성립되어야 하고 상대방이 응답하지 않으면 계속 패킷을 보내는 것은 불가능하기 때문

### DRDOS
TCP로 DDOS 비슷한 것을 하는 것
* 공격 대상 서버의 IP와 포트 번호로 TCP 패킷을 임의의 서버에 보냄
* 공격 대상의 서버는 전국 각지의 서버에서 갑자기 ACK 트래픽을 받게 되는 것
* 임의의 서버 또한 SYN 패킷을 받게됨
* 공격 대상 서버는 실제 공격자가 누군지 알 수 없다.

### DDOS 방지
LOL 서버의 예시
* 홀펀칭으로 인해 유저 IP와 포트 유출
* 여기로 DDOS를 걸어서 문제가 되었었음
* 프록시 서버를 두고 프록시 서버가 마비되면 다른 프록시 서버로 교체하는 방식으로 해결
* 실제 유저 IP가 노출되지 않고 프록시 서버의 IP가 보인다.

### 영역별 포트
* 0~1023 : Well known ports
* 1024~49151 : Registered ports
* 49152~65535 : dynamic ports
  * 서버에 접속할 때 따로 지정하지 않으면 이 중에서 가져다 씀
* 우리가 서버를 만들 때는 1024~65535를 사용